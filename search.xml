<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title><![CDATA[Classification]]></title>
    <url>%2F2018%2F05%2F18%2F180518-logistic%E5%A4%9A%E7%B1%BB%E5%88%86%E7%B1%BB%2F</url>
    <content type="text"><![CDATA[åœ¨æ­¤ç»ƒä¹ ä¸­ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨logisticå›žå½’å’Œç¥žç»ç½‘ç»œæ¥è¯†åˆ«æ‰‹å†™æ•°å­—ï¼ˆ0åˆ°9ï¼‰ã€‚ 1 å¤šç±»åˆ†ç±»(å¤šä¸ªlogisticå›žå½’)æˆ‘ä»¬å°†æ‰©å±•æˆ‘ä»¬åœ¨ç»ƒä¹ 2ä¸­å†™çš„logisticå›žå½’çš„å®žçŽ°ï¼Œå¹¶å°†å…¶åº”ç”¨äºŽä¸€å¯¹å¤šçš„åˆ†ç±»ï¼ˆä¸æ­¢ä¸¤ä¸ªç±»åˆ«ï¼‰ã€‚ 1234import numpy as npimport pandas as pdimport matplotlib.pyplot as pltfrom scipy.io import loadmat Dataseté¦–å…ˆï¼ŒåŠ è½½æ•°æ®é›†ã€‚è¿™é‡Œçš„æ•°æ®ä¸ºMATLABçš„æ ¼å¼ï¼Œæ‰€ä»¥è¦ä½¿ç”¨SciPy.ioçš„loadmatå‡½æ•°ã€‚ 12345def load_data(path): data = loadmat(path) X = data['X'] y = data['y'] return X,y 12345X, y = load_data('ex3data1.mat')print(np.unique(y)) # çœ‹ä¸‹æœ‰å‡ ç±»æ ‡ç­¾# [ 1 2 3 4 5 6 7 8 9 10]X.shape, y.shape# ((5000, 400), (5000, 1)) å…¶ä¸­æœ‰5000ä¸ªè®­ç»ƒæ ·æœ¬ï¼Œæ¯ä¸ªæ ·æœ¬æ˜¯20*20åƒç´ çš„æ•°å­—çš„ç°åº¦å›¾åƒã€‚æ¯ä¸ªåƒç´ ä»£è¡¨ä¸€ä¸ªæµ®ç‚¹æ•°ï¼Œè¡¨ç¤ºè¯¥ä½ç½®çš„ç°åº¦å¼ºåº¦ã€‚20Ã—20çš„åƒç´ ç½‘æ ¼è¢«å±•å¼€æˆä¸€ä¸ª400ç»´çš„å‘é‡ã€‚åœ¨æˆ‘ä»¬çš„æ•°æ®çŸ©é˜µXä¸­ï¼Œæ¯ä¸€ä¸ªæ ·æœ¬éƒ½å˜æˆäº†ä¸€è¡Œï¼Œè¿™ç»™äº†æˆ‘ä»¬ä¸€ä¸ª5000Ã—400çŸ©é˜µXï¼Œæ¯ä¸€è¡Œéƒ½æ˜¯ä¸€ä¸ªæ‰‹å†™æ•°å­—å›¾åƒçš„è®­ç»ƒæ ·æœ¬ã€‚ ç¬¬ä¸€ä¸ªä»»åŠ¡æ˜¯å°†æˆ‘ä»¬çš„é€»è¾‘å›žå½’å®žçŽ°ä¿®æ”¹ä¸ºå®Œå…¨å‘é‡åŒ–ï¼ˆå³æ²¡æœ‰â€œforâ€å¾ªçŽ¯ï¼‰ã€‚è¿™æ˜¯å› ä¸ºå‘é‡åŒ–ä»£ç é™¤äº†ç®€æ´å¤–ï¼Œè¿˜èƒ½å¤Ÿåˆ©ç”¨çº¿æ€§ä»£æ•°ä¼˜åŒ–ï¼Œå¹¶ä¸”é€šå¸¸æ¯”è¿­ä»£ä»£ç å¿«å¾—å¤šã€‚ 1.2 Visualizing the data123456789101112def plot_an_image(X): """ éšæœºæ‰“å°ä¸€ä¸ªæ•°å­— """ pick_one = np.random.randint(0, 5000) image = X[pick_one, :] fig, ax = plt.subplots(figsize=(1, 1)) ax.matshow(image.reshape((20, 20)), cmap='gray_r') plt.xticks([]) # åŽ»é™¤åˆ»åº¦ï¼Œç¾Žè§‚ plt.yticks([]) plt.show() print('this should be &#123;&#125;'.format(y[pick_one])) 12345678910111213141516def plot_100_image(X): """ éšæœºç”»100ä¸ªæ•°å­— """ sample_idx = np.random.choice(np.arange(X.shape[0]), 100) # éšæœºé€‰100ä¸ªæ ·æœ¬ sample_images = X[sample_idx, :] # (100,400) fig, ax_array = plt.subplots(nrows=10, ncols=10, sharey=True, sharex=True, figsize=(8, 8)) for row in range(10): for column in range(10): ax_array[row, column].matshow(sample_images[10 * row + column].reshape((20, 20)), cmap='gray_r') plt.xticks([]) plt.yticks([]) plt.show() 1.3 Vectorizing Logistic Regressionæˆ‘ä»¬å°†ä½¿ç”¨å¤šä¸ªone-vs-all(ä¸€å¯¹å¤š)logisticå›žå½’æ¨¡åž‹æ¥æž„å»ºä¸€ä¸ªå¤šç±»åˆ†ç±»å™¨ã€‚ç”±äºŽæœ‰10ä¸ªç±»ï¼Œéœ€è¦è®­ç»ƒ10ä¸ªç‹¬ç«‹çš„åˆ†ç±»å™¨ã€‚ä¸ºäº†æé«˜è®­ç»ƒæ•ˆçŽ‡ï¼Œé‡è¦çš„æ˜¯å‘é‡åŒ–ã€‚åœ¨æœ¬èŠ‚ä¸­ï¼Œæˆ‘ä»¬å°†å®žçŽ°ä¸€ä¸ªä¸ä½¿ç”¨ä»»ä½•forå¾ªçŽ¯çš„å‘é‡åŒ–çš„logisticå›žå½’ç‰ˆæœ¬ã€‚ é¦–å…ˆå‡†å¤‡ä¸‹æ•°æ®ã€‚ 1.3.1 Vectorizing the cost functioné¦–å…ˆå†™å‡ºå‘é‡åŒ–çš„ä»£ä»·å‡½æ•°ã€‚å›žæƒ³æ­£åˆ™åŒ–çš„logisticå›žå½’çš„ä»£ä»·å‡½æ•°æ˜¯ï¼š $$ J\left( \theta \right)=\frac{1}{m}\sum\limits_{i=1}^{m}{[-{{y}^{(i)}}\log \left( {{h}_{\theta }}\left( {{x}^{(i)}} \right) \right)-\left( 1-{{y}^{(i)}} \right)\log \left( 1-{{h}_{\theta }}\left( {{x}^{(i)}} \right) \right)]}+\frac{\lambda}{2m}\sum^n_{j=1}\theta^2_j $$ é¦–å…ˆæˆ‘ä»¬å¯¹æ¯ä¸ªæ ·æœ¬ $i$ è¦è®¡ç®—$h_{\theta}(x^{(i)})$ï¼Œ$h_{\theta}(x^{(i)})=g(\theta^Tx^{(i)})$ï¼Œ$g(z)=\frac{1}{1+e^{-z}}$ sigmoidå‡½æ•°ã€‚ äº‹å®žä¸Šæˆ‘ä»¬å¯ä»¥å¯¹æ‰€æœ‰çš„æ ·æœ¬ç”¨çŸ©é˜µä¹˜æ³•æ¥å¿«é€Ÿçš„è®¡ç®—ã€‚è®©æˆ‘ä»¬å¦‚ä¸‹æ¥å®šä¹‰ $X$ å’Œ $\theta$ ï¼š ç„¶åŽé€šè¿‡è®¡ç®—çŸ©é˜µç§¯ $X\theta$ ï¼Œæˆ‘ä»¬å¯ä»¥å¾—åˆ°ï¼š åœ¨æœ€åŽä¸€ä¸ªç­‰å¼ä¸­ï¼Œæˆ‘ä»¬ç”¨åˆ°äº†ä¸€ä¸ªå®šç†ï¼Œå¦‚æžœ $a$ å’Œ $b$ éƒ½æ˜¯å‘é‡ï¼Œé‚£ä¹ˆ $a^Tb=b^Ta$ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥ç”¨ä¸€è¡Œä»£ç è®¡ç®—å‡ºæ‰€æœ‰çš„æ ·æœ¬ã€‚ 12def sigmoid(z): return 1 / (1 + np.exp(-z)) 123456789101112def regularized_cost(theta, X, y, l): """ don't penalize theta_0 args: X: feature matrix, (m, n+1) # æ’å…¥äº†x0=1 y: target vector, (m, ) l: lambda constant for regularization """ thetaReg = theta[1:] first = (-y*np.log(sigmoid(X@theta))) + (y-1)*np.log(1-sigmoid(X@theta)) reg = (thetaReg@thetaReg)*l / (2*len(X)) return np.mean(first) + reg 1.3.2 Vectorizing the gradientå›žé¡¾æ­£åˆ™åŒ–logisticå›žå½’ä»£ä»·å‡½æ•°çš„æ¢¯åº¦ä¸‹é™æ³•å¦‚ä¸‹è¡¨ç¤ºï¼Œå› ä¸ºä¸æƒ©ç½štheta_0ï¼Œæ‰€ä»¥åˆ†ä¸ºä¸¤ç§æƒ…å†µï¼š æ‰€ä»¥å…¶ä¸­çš„æ¢¯åº¦è¡¨ç¤ºå¦‚ä¸‹ï¼š 12345678910111213def regularized_gradient(theta, X, y, l): """ don't penalize theta_0 args: l: lambda constant return: a vector of gradient """ thetaReg = theta[1:] first = (1 / len(X)) * X.T @ (sigmoid(X @ theta) - y) # è¿™é‡Œäººä¸ºæ’å…¥ä¸€ç»´0ï¼Œä½¿å¾—å¯¹theta_0ä¸æƒ©ç½šï¼Œæ–¹ä¾¿è®¡ç®— reg = np.concatenate([np.array([0]), (l / len(X)) * thetaReg]) return first + reg 1.4 One-vs-all Classificationè¿™éƒ¨åˆ†æˆ‘ä»¬å°†å®žçŽ°ä¸€å¯¹å¤šåˆ†ç±»é€šè¿‡è®­ç»ƒå¤šä¸ªæ­£åˆ™åŒ–logisticå›žå½’åˆ†ç±»å™¨ï¼Œæ¯ä¸ªå¯¹åº”æ•°æ®é›†ä¸­Kç±»ä¸­çš„ä¸€ä¸ªã€‚ å¯¹äºŽè¿™ä¸ªä»»åŠ¡ï¼Œæˆ‘ä»¬æœ‰10ä¸ªå¯èƒ½çš„ç±»ï¼Œå¹¶ä¸”ç”±äºŽlogisticå›žå½’åªèƒ½ä¸€æ¬¡åœ¨2ä¸ªç±»ä¹‹é—´è¿›è¡Œåˆ†ç±»ï¼Œæ¯ä¸ªåˆ†ç±»å™¨åœ¨â€œç±»åˆ« iâ€å’Œâ€œä¸æ˜¯ iâ€ä¹‹é—´å†³å®šã€‚ æˆ‘ä»¬å°†æŠŠåˆ†ç±»å™¨è®­ç»ƒåŒ…å«åœ¨ä¸€ä¸ªå‡½æ•°ä¸­ï¼Œè¯¥å‡½æ•°è®¡ç®—10ä¸ªåˆ†ç±»å™¨ä¸­çš„æ¯ä¸ªåˆ†ç±»å™¨çš„æœ€ç»ˆæƒé‡ï¼Œå¹¶å°†æƒé‡è¿”å›žshapeä¸º(k, (n+1))æ•°ç»„ï¼Œå…¶ä¸­ n æ˜¯å‚æ•°æ•°é‡ã€‚ 12345678910111213141516171819202122from scipy.optimize import minimizedef one_vs_all(X, y, l, K): """generalized logistic regression args: X: feature matrix, (m, n+1) # with incercept x0=1 y: target vector, (m, ) l: lambda constant for regularization K: numbel of labels return: trained parameters """ all_theta = np.zeros((K, X.shape[1])) # (10, 401) for i in range(1, K+1): theta = np.zeros(X.shape[1]) y_i = np.array([1 if label == i else 0 for label in y]) ret = minimize(fun=regularized_cost, x0=theta, args=(X, y_i, l), method='TNC', jac=regularized_gradient, options=&#123;'disp': True&#125;) all_theta[i-1,:] = ret.x return all_theta è¿™é‡Œéœ€è¦æ³¨æ„çš„å‡ ç‚¹ï¼šé¦–å…ˆï¼Œæˆ‘ä»¬ä¸ºXæ·»åŠ äº†ä¸€åˆ—å¸¸æ•°é¡¹ 1 ï¼Œä»¥è®¡ç®—æˆªè·é¡¹ï¼ˆå¸¸æ•°é¡¹ï¼‰ã€‚ å…¶æ¬¡ï¼Œæˆ‘ä»¬å°†yä»Žç±»æ ‡ç­¾è½¬æ¢ä¸ºæ¯ä¸ªåˆ†ç±»å™¨çš„äºŒè¿›åˆ¶å€¼ï¼ˆè¦ä¹ˆæ˜¯ç±»iï¼Œè¦ä¹ˆä¸æ˜¯ç±»iï¼‰ã€‚ æœ€åŽï¼Œæˆ‘ä»¬ä½¿ç”¨SciPyçš„è¾ƒæ–°ä¼˜åŒ–APIæ¥æœ€å°åŒ–æ¯ä¸ªåˆ†ç±»å™¨çš„ä»£ä»·å‡½æ•°ã€‚ å¦‚æžœæŒ‡å®šçš„è¯ï¼ŒAPIå°†é‡‡ç”¨ç›®æ ‡å‡½æ•°ï¼Œåˆå§‹å‚æ•°é›†ï¼Œä¼˜åŒ–æ–¹æ³•å’Œjacobianï¼ˆæ¸å˜ï¼‰å‡½æ•°ã€‚ ç„¶åŽå°†ä¼˜åŒ–ç¨‹åºæ‰¾åˆ°çš„å‚æ•°åˆ†é…ç»™å‚æ•°æ•°ç»„ã€‚ å®žçŽ°å‘é‡åŒ–ä»£ç çš„ä¸€ä¸ªæ›´å…·æŒ‘æˆ˜æ€§çš„éƒ¨åˆ†æ˜¯æ­£ç¡®åœ°å†™å…¥æ‰€æœ‰çš„çŸ©é˜µï¼Œä¿è¯ç»´åº¦æ­£ç¡®ã€‚ 12345678910def predict_all(X, all_theta): # compute the class probability for each class on each training instance h = sigmoid(X @ all_theta.T) # æ³¨æ„çš„è¿™é‡Œçš„all_thetaéœ€è¦è½¬ç½® # create array of the index with the maximum probability # Returns the indices of the maximum values along an axis. h_argmax = np.argmax(h, axis=1) # because our array was zero-indexed we need to add one for the true label prediction h_argmax = h_argmax + 1 return h_argmax è¿™é‡Œçš„hå…±5000è¡Œï¼Œ10åˆ—ï¼Œæ¯è¡Œä»£è¡¨ä¸€ä¸ªæ ·æœ¬ï¼Œæ¯åˆ—æ˜¯é¢„æµ‹å¯¹åº”æ•°å­—çš„æ¦‚çŽ‡ã€‚æˆ‘ä»¬å–æ¦‚çŽ‡æœ€å¤§å¯¹åº”çš„indexåŠ 1å°±æ˜¯æˆ‘ä»¬åˆ†ç±»å™¨æœ€ç»ˆé¢„æµ‹å‡ºæ¥çš„ç±»åˆ«ã€‚è¿”å›žçš„h_argmaxæ˜¯ä¸€ä¸ªarrayï¼ŒåŒ…å«5000ä¸ªæ ·æœ¬å¯¹åº”çš„é¢„æµ‹å€¼ã€‚ 123456raw_X, raw_y = load_data('ex3data1.mat')X = np.insert(raw_X, 0, 0, axis=1) # (5000, 401)y = raw_y.flatten() # è¿™é‡Œæ¶ˆé™¤äº†ä¸€ä¸ªç»´åº¦ï¼Œæ–¹ä¾¿åŽé¢çš„è®¡ç®— or .reshape(-1) ï¼ˆ5000ï¼Œï¼‰all_theta = one_vs_all(X, y, 1, 10)all_theta # æ¯ä¸€è¡Œæ˜¯ä¸€ä¸ªåˆ†ç±»å™¨çš„ä¸€ç»„å‚æ•° 123y_pred = predict_all(X, all_theta)accuracy = np.mean(y_pred == y)print ('accuracy = &#123;0&#125;%'.format(accuracy * 100)) Tips: pythonä¸­ trueå°±æ˜¯1ï¼Œ1å°±æ˜¯trueï¼Œfalseå°±æ˜¯0ï¼Œ0å°±æ˜¯false 2 Neural Networksä¸Šé¢ä½¿ç”¨äº†å¤šç±»logisticå›žå½’ï¼Œç„¶è€Œlogisticå›žå½’ä¸èƒ½å½¢æˆæ›´å¤æ‚çš„å‡è®¾ï¼Œå› ä¸ºå®ƒåªæ˜¯ä¸€ä¸ªçº¿æ€§åˆ†ç±»å™¨ã€‚ æŽ¥ä¸‹æ¥æˆ‘ä»¬ç”¨ç¥žç»ç½‘ç»œæ¥å°è¯•ä¸‹ï¼Œç¥žç»ç½‘ç»œå¯ä»¥å®žçŽ°éžå¸¸å¤æ‚çš„éžçº¿æ€§çš„æ¨¡åž‹ã€‚æˆ‘ä»¬å°†åˆ©ç”¨å·²ç»è®­ç»ƒå¥½äº†çš„æƒé‡è¿›è¡Œé¢„æµ‹ã€‚ 123def load_weight(path): data = loadmat(path) return data['Theta1'], data['Theta2'] 123theta1, theta2 = load_weight('ex3weights.mat')theta1.shape, theta2.shape 12345X, y = load_data('ex3data1.mat')y = y.flatten()X = np.insert(X, 0, values=np.ones(X.shape[0]), axis=1) # interceptX.shape, y.shape 123a1 = Xz2 = a1 @ theta1.Tz2.shape 1z2 = np.insert(z2, 0, 1, axis=1) 12a2 = sigmoid(z2)a2.shape 12z3 = a2 @ theta2.Tz3.shape 12a3 = sigmoid(z3)a3.shape 123y_pred = np.argmax(a3, axis=1) + 1 accuracy = np.mean(y_pred == y)print ('accuracy = &#123;0&#125;%'.format(accuracy * 100)) # accuracy = 97.52% è™½ç„¶äººå·¥ç¥žç»ç½‘ç»œæ˜¯éžå¸¸å¼ºå¤§çš„æ¨¡åž‹ï¼Œä½†è®­ç»ƒæ•°æ®çš„å‡†ç¡®æ€§å¹¶ä¸èƒ½å®Œç¾Žé¢„æµ‹å®žé™…æ•°æ®ï¼Œåœ¨è¿™é‡Œå¾ˆå®¹æ˜“è¿‡æ‹Ÿåˆã€‚]]></content>
      <categories>
        <category>æœºå™¨å­¦ä¹ </category>
      </categories>
      <tags>
        <tag>æœºå™¨å­¦ä¹ </tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[GitHub Pagesè‡ªå®šä¹‰åŸŸåå¦‚ä½•æ”¯æŒhttps]]></title>
    <url>%2F2018%2F05%2F14%2F180514-githubpages%2F</url>
    <content type="text"><![CDATA[å°±åœ¨å‰ä¸ä¹…ï¼ŒGitHub Pageså¼€æ”¾äº†è‡ªå®šä¹‰åŸŸåæ”¯æŒHTTPSã€‚è¿™æ„å‘³ç€å¹¿å¤§ç”¨GitHub Pagesæ­å»ºä¸ªäººåšå®¢çš„åŒå­¦ä»¬æœ‰ç¦äº†ï¼Œä¸ç”¨å†è‡ªå·±ä¹°è¯ä¹¦æˆ–å€Ÿç”¨ç¬¬ä¸‰æ–¹æœåŠ¡ï¼Œå°±èƒ½å¼€å¯ç½‘å€å·¦è¾¹çš„å°ç»¿é”å•¦ï¼Œéžå¸¸çœå¿ƒã€‚è¯¦ç»†ä¿¡æ¯ç‚¹æˆ‘ã€‚ æœ€åŽæ•ˆæžœå¦‚å›¾ï¼š è®¾ç½®æ­¥éª¤æ ¹æ®ä½ çš„è‡ªå®šä¹‰åŸŸåè§£æžç±»åž‹åˆ†ä¸ºä¸¤ç§ï¼š1. CNAMEï¼Œ2. Aã€‚ 1 CNAMEåªéœ€è¦åœ¨repositorysè®¾ç½®ä¸­å¼€å¯Enforce HTTPSçš„é€‰é¡¹å³å¯ã€‚ è‹¥å‘çŽ°å¤é€‰æ¡†ä¸ºç°è‰²å¼€å¯ä¸äº†ï¼Œå¯ä»¥å°†Custom domainé‚£ä¸€æ çš„å†…å®¹åˆ é™¤ç½®ä¸ºç©ºï¼Œç‚¹å‡»saveä¿å­˜ã€‚å†æ¬¡å¡«å…¥ä½ çš„è‡ªå®šä¹‰åŸŸåï¼Œç‚¹å‡»saveä¿å­˜ã€‚ä¼šå‡ºçŽ°è¿™æ ·çš„æç¤ºï¼š è¯´æ˜Žä½ çš„è¯ä¹¦è¿˜æ²¡å‘å®Œï¼Œè€å¿ƒç­‰å¾…å³å¯ã€‚æˆ‘ç­‰å¾…äº†ä¸‰å¤©å·¦å³æ‰æˆåŠŸï¼Œå¯èƒ½æ˜¯çŽ°åœ¨ç”³è¯·çš„äººå¤ªå¤šã€‚ 2 AAè®°å½•çš„è¯åªéœ€å°†è§£æžçš„ipæŒ‡å‘å¦‚ä¸‹å››ä¸ªå³å¯ï¼Œé—®é¢˜å®˜æ–¹é“¾æŽ¥ã€‚ 1234185.199.108.153185.199.109.153185.199.110.153185.199.111.153 å…¶ä½™çš„æ­¥éª¤å’Œä¸Šé¢ç›¸ä¼¼ã€‚ æœ€é‡è¦çš„æ˜¯ç­‰å¾…ï¼Œç„¶åŽä½ å°±å¯ä»¥æ‹¥æœ‰ä½ è‡ªå·±çš„å°ç»¿é”å•¦ã€‚ðŸ˜Š]]></content>
      <categories>
        <category>Github</category>
      </categories>
      <tags>
        <tag>Github</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ä½ å¥½ï¼Œç†ŠçŒ«]]></title>
    <url>%2F2018%2F05%2F10%2F%E4%BD%A0%E5%A5%BD%EF%BC%8C%E7%86%8A%E7%8C%AB%2F</url>
    <content type="text"><![CDATA[å“ˆå“ˆ]]></content>
      <categories>
        <category>æ—¥å¸¸</category>
      </categories>
      <tags>
        <tag>æ—¥å¸¸</tag>
      </tags>
  </entry>
</search>
